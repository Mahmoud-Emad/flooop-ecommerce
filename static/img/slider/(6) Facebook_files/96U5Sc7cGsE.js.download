if (self.CavalryLogger) { CavalryLogger.start_js(["ECq6G"]); }

__d("CometUFIComposer_actor.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[{defaultValue:!1,kind:"LocalArgument",name:"__false"}],kind:"Fragment",metadata:null,name:"CometUFIComposer_actor",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{args:null,kind:"FragmentSpread",name:"CometUFICommentRow_actor"}],type:"Actor",abstractKey:"__isActor"};e.exports=a}),null);
__d("CometUFIComposer_feedback.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometUFIComposer_feedback",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Feedback",abstractKey:null};e.exports=a}),null);
__d("CometUFIComposerActions.react",["CometErrorBoundary.react","CometTooltipGroup.react","React","gkx","stylex"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g,h=b("React");function a(a){return h.jsx(b("CometTooltipGroup.react"),{children:h.jsx("ul",{className:(g||(g=b("stylex"))).dedupe(b("gkx")("1704113")?{"align-self-1":"c4hnarmi","height-1":"tv7at329"}:{"align-self-1":"c4hnarmi","display-1":"j83agx80","filter-1":"bdca9zbp","flex-direction-1":"btwxx1t3","height-1":"kn9t4qvh","margin-end-1":"oi9244e8","margin-start-1":"fop5sh7t"}),children:h.Children.map(a.children,function(a,c){return h.jsx(b("CometErrorBoundary.react"),{children:h.jsx("li",{className:(g||(g=b("stylex"))).dedupe(b("gkx")("1704113")?{"display-1":"q9uorilb","margin-start-1":"fop5sh7t"}:{"cursor-1":"nhd2j8a9","display-1":"j83agx80","filter-1":"bdca9zbp"}),children:a})},c)})})})}}),null);
__d("CometUFIComposerOnBeforeUnloader.react",["fbt","React","useOnBeforeUnload"],(function(a,b,c,d,e,f,g){"use strict";e.exports=a;b("React");function a(a){b("useOnBeforeUnload")(function(){if(a.isUnfinished())return{warnMessage:g._("\u0644\u0645 \u062a\u0643\u0645\u0644 \u062a\u0639\u0644\u064a\u0642\u0643 \u0628\u0639\u062f. \u0647\u0644 \u062a\u0631\u064a\u062f \u0627\u0644\u0645\u063a\u0627\u062f\u0631\u0629 \u0642\u0628\u0644 \u0627\u0644\u0627\u0646\u062a\u0647\u0627\u0621\u061f")}});return null}}),null);
__d("getNodeForCharacterOffset",[],(function(a,b,c,d,e,f){"use strict";var g=3;function h(a){while(a&&a.firstChild)a=a.firstChild;return a}function i(a){while(a){if(a.nextSibling)return a.nextSibling;a=a.parentNode}}function a(a,b){a=h(a);var c=0,d;while(a){if(a.nodeType===g){d=c+a.textContent.length;if(c<=b&&d>=b)return{node:a,offset:b-c};c=d}a=h(i(a))}}e.exports=a}),null);
__d("getTextContentAccessor",["fbjs/lib/ExecutionEnvironment"],(function(a,b,c,d,e,f){"use strict";var g=null;function a(){!g&&b("fbjs/lib/ExecutionEnvironment").canUseDOM&&(g="textContent"in document.documentElement?"textContent":"innerText");return g}e.exports=a}),null);
__d("ReactDOMSelection",["getNodeForCharacterOffset","getTextContentAccessor"],(function(a,b,c,d,e,f){"use strict";function g(a,b,c,d){return a===c&&b===d}function a(a){var b=window.getSelection&&window.getSelection();if(!b||b.rangeCount===0)return null;var c=b.anchorNode,d=b.anchorOffset,e=b.focusNode,f=b.focusOffset,h=b.getRangeAt(0);try{h.startContainer.nodeType,h.endContainer.nodeType}catch(a){return null}b=g(b.anchorNode,b.anchorOffset,b.focusNode,b.focusOffset);b=b?0:h.toString().length;var i=h.cloneRange();i.selectNodeContents(a);i.setEnd(h.startContainer,h.startOffset);a=g(i.startContainer,i.startOffset,i.endContainer,i.endOffset);h=a?0:i.toString().length;a=h+b;i=document.createRange();i.setStart(c,d);i.setEnd(e,f);b=i.collapsed;return{start:b?a:h,end:b?h:a}}function c(a,c){if(!window.getSelection)return;var d=window.getSelection(),e=a[b("getTextContentAccessor")()].length,f=Math.min(c.start,e);c=c.end===void 0?f:Math.min(c.end,e);if(!d.extend&&f>c){e=c;c=f;f=e}e=b("getNodeForCharacterOffset")(a,f);a=b("getNodeForCharacterOffset")(a,c);if(e&&a){var g=document.createRange();g.setStart(e.node,e.offset);d.removeAllRanges();f>c?(d.addRange(g),d.extend(a.node,a.offset)):(g.setEnd(a.node,a.offset),d.addRange(g))}}d={getOffsets:a,setOffsets:c};e.exports=d}),null);
__d("getPlainTextFromCometUFIInputState",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){switch(a.__type){case"plain-text":return a.text;case"editor-state-based":return a.editorState.getCurrentContent().getPlainText();default:return a}}}),null);
__d("CometUFIProgressiveComposerInput.react",["Promise","CometProgressivelyEnhancedComponent.react","Event","FBLogger","FocusRegion.react","Keys","requireDeferred","React","ReactDOMSelection","SubscriptionsHandler","deferredLoadComponent","clearImmediate","clearTimeout","emptyFunction","getPlainTextFromCometUFIInputState","ifRequireable","isCometUFIComposerStateEmpty","isSoftNewlineEvent","setImmediateAcrossTransitions","setTimeoutAcrossTransitions","stylex"],(function(a,b,c,d,e,f){"use strict";var g,h=b("Keys").BACKSPACE,i=b("Keys").DELETE,j=b("Keys").RETURN,k=b("React"),l=b("requireDeferred")("UFI2RichComposerInput.react"),m=b("deferredLoadComponent")(l),n=b("requireDeferred")("getEditorStateFromUFI2ComposerState"),o={disabledProxyInput:{cursor:"bnpdmtie"},emptyPlaceholder:{overflowX:"ni8dbmo4",overflowY:"stjgntxs",textOverflow:"ltmttdrg",whiteSpace:"mshkm1ct"},proxyInput:{backgroundColor:"g5ia77u1",borderTop:"qu0x051f",borderEnd:"esr5mh6w",borderBottom:"e9989ue4",borderStart:"r7d6kgcz",color:"oo9gr5id",height:"datstx6m",outline:"lzcic4wl",resize:"ieid39z1",wordBreak:"qv66sw1b",zIndex:"tkr6xdv7"},proxyInputPlaceholder:{bottom:"i09qtzwb",color:"m9osqain",end:"n7fi1qx3",overflowX:"ni8dbmo4",overflowY:"stjgntxs",pointerEvents:"hzruof5a",position:"pmk7jnqg",start:"j9ispegn",textOverflow:"ltmttdrg",top:"kr520xx4"},proxyInputPlaceholderForFocusedInput:{color:"pipptul6"},proxyInputWrapper:{height:"datstx6m",position:"l9j0dhe7"}};function p(a){a=a.innerText||"";a.replace(/(\r\n|\r|\n)/g,"")===""&&(a="");return a}function q(){return b("ifRequireable")("EditorState",function(a){var b=l.getModuleIfRequireable();if(b!=null){var c=n.getModuleIfRequireable();if(c!=null)return{EditorState:a,UFI2RichComposerInput:b,getEditorStateFromUFI2ComposerState:c}}})}a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.$1=!1,d.$2=null,d.$3=!1,d.$4=null,d.$5=new(b("SubscriptionsHandler"))(),d.state={proxyInputHasFocus:!1,proxyIsInCompositionMode:!1},d.$8=function(a){d.$9()},d.$10=function(a){d.setState({proxyIsInCompositionMode:!0})},d.$11=function(a){d.setState({proxyIsInCompositionMode:!1})},d.$12=function(a){d.$9()},d.$13=function(a){d.$14(a.target)},d.$15=function(a){d.$2=d.$4!=null&&document.activeElement===d.$4?b("ReactDOMSelection").getOffsets(d.$4):null,d.$4=a,d.props.onInputRefUpdated&&d.props.onInputRefUpdated(a)},d.$16=function(a){a.keyCode===j&&!b("isSoftNewlineEvent")(a)?(a.preventDefault(),d.props.onCommit()):(a.keyCode===h||a.keyCode===i)&&d.$9()},d.$17=function(a){d.$3=!0;var c=b("setTimeoutAcrossTransitions")(function(){b("FBLogger")("ufi2").warn("_handleProxyMouseDown had no corresonding mouseup event for 30s.")},3e4);d.$5.addSubscriptions({remove:function(){b("clearTimeout")(c)}});var e=b("Event").listen(document,"mouseup",function(){b("clearTimeout")(c),d.$3=!1,d.$5.releaseOne(e),d.$4!=null&&d.$4===document.activeElement&&d.$6()});d.$5.addSubscriptions(e)},d.$18=function(a){var b=d.props.handlePastedFiles;if(b){var c=a.clipboardData;c=c.items!=null?Array.from(c.items):[];c=c.map(function(a){return a.getAsFile()}).filter(Boolean);c.length&&(b(c)==="handled"&&a.preventDefault())}a.isDefaultPrevented()===!1&&d.$9()},d.$20=function(a){d.setState({proxyInputHasFocus:!1})},d.$21=function(a){var c=function(){d.$3===!1&&d.$6()},e=q();e==null?(l.loadImmediately(b("emptyFunction")),n.loadImmediately(function(){return c()})):c();d.setState({proxyInputHasFocus:!0});d.props.onFocus&&d.props.onFocus(a)},c)||babelHelpers.assertThisInitialized(d)}c.createEmptyComposerState=function(){var a=q();a=a==null?void 0:a.EditorState;return a!=null?{__type:"editor-state-based",editorState:a.createEmpty()}:{__type:"plain-text",selectionOffsets:null,text:""}};var d=c.prototype;d.$6=function(){var a=this;if(this.state.proxyIsInCompositionMode===!0||this.props.composerState.inputState.__type!=="plain-text")return;var c=q();if(c==null)return;this.props.onComposerStateChange(function(d){var e,f=d.inputState;if(f.__type!=="plain-text"){b("FBLogger")("ufi2").warn("We were asked to commit the text and selection state of the proxy input, but the current input state is of type `%s` when we expected it to be of type `plain-text`. Investigate why a reference to the proxy input existed when the input state was of this type.",f.__type);return d}e=babelHelpers["extends"]({},d,{inputState:babelHelpers["extends"]({},f,{selectionOffsets:(e=a.$2)!=null?e:f.selectionOffsets})});return babelHelpers["extends"]({},d,{inputState:{__type:"editor-state-based",editorState:c.getEditorStateFromUFI2ComposerState(e)}})})};d.$7=function(){b("isCometUFIComposerStateEmpty")(this.props.composerState)!==!0&&this.$6()};d.$14=function(a){this.$1=!1;var c=p(a);this.props.onComposerStateChange(function(a){var d=a.inputState;if(d.__type!=="plain-text"){b("FBLogger")("ufi2").warn("We were asked to handle an input event for the proxy input, but the current input state is of type `%s` when we expected it to be of type `plain-text`. Investigate why a reference to the proxy input existed when the input state was of this type.",d.__type);return a}return babelHelpers["extends"]({},a,{inputState:babelHelpers["extends"]({},d,{text:c})})})};d.$19=function(a){if(a.composerState.inputState.__type!=="plain-text")return;var c=this.$4;if(c){a=a.composerState.inputState;var d,e;switch(a.__type){case"plain-text":d=a.text;e=a.selectionOffsets;break;case"editor-state-based":default:d=a.editorState.getCurrentContent().getBlockMap().map(function(a){return a?a.getText():""}).join("\n");b("FBLogger")("ufi2").warn("Unimplemented: tried to update the UFI2 proxy input's selection using an `EditorState` but we have not yet implemented a function that maps from an `EditorState` to selection offsets.");break}e==null&&(e=document.activeElement===c?b("ReactDOMSelection").getOffsets(c):null);a=p(c);d!==a&&(c.textContent=d,e!=null&&(d===""?(c.innerText="\xa0",b("ReactDOMSelection").setOffsets(c,{end:1,start:1}),document.execCommand("delete",!1,null)):b("ReactDOMSelection").setOffsets(c,e)))}};d.$9=function(){var a=this;if(this.$1)return;this.$1=!0;var c=b("setImmediateAcrossTransitions")(function(){a.$1&&(a.$1=!1,a.$4&&a.$14(a.$4))});this.$5.addSubscriptions({remove:function(){b("clearImmediate")(c)}})};d.componentDidMount=function(){var a=this,b=this.props.composerState.inputState;this.$4&&b.__type==="plain-text"&&this.$19(this.props);b=q();(b==null?void 0:b.UFI2RichComposerInput)==null&&this.$5.addSubscriptions(l.onReady(function(b){a.props.composerState.inputState.__type==="editor-state-based"&&a.forceUpdate()}))};d.componentDidUpdate=function(){this.props.composerState.inputState.__type==="plain-text"&&this.$7(),this.$19(this.props)};d.componentWillUnmount=function(){this.$5.release()};d.execCommand=function(a){this.props.handleCommand&&(a.__type==="PrefillMention"&&(l.loadImmediately(b("emptyFunction")),this.$6()),this.props.handleCommand(a))};d.render=function(){var a=this.props,c=a.xstyle;a=babelHelpers.objectWithoutPropertiesLoose(a,["xstyle"]);var d=b("getPlainTextFromCometUFIInputState")(a.composerState.inputState).trim()!=="",e=a.depth?"UFI2ComposerInput/reply":"UFI2ComposerInput/comment",f=k.jsx("div",{className:(g||(g=b("stylex")))(c),onClick:a.onClick,role:"none",children:k.jsxs("div",{className:g(o.proxyInputWrapper),children:[k.jsx("div",{className:g(a.composerState.isLocked?o.disabledProxyInput:null,o.proxyInput),contentEditable:a.composerState.isLocked===!1,"data-testid":void 0,onBeforeInput:this.$8,onBlur:this.$20,onCompositionEnd:this.$11,onCompositionStart:this.$10,onCut:this.$12,onFocus:this.$21,onInput:this.$13,onKeyDown:this.$16,onMouseDown:this.$17,onPaste:this.$18,ref:this.$15,role:"textbox",tabIndex:0}),d?null:k.jsx("div",{className:(g||(g=b("stylex")))(o.proxyInputPlaceholder,this.state.proxyInputHasFocus&&o.proxyInputPlaceholderForFocusedInput),children:a.placeholder})]})});return k.jsx(b("FocusRegion.react").FocusRegion,{recoverFocusQuery:null,children:k.jsxs(b("CometProgressivelyEnhancedComponent.react"),{fallback:f,forceFallback:this.state.proxyIsInCompositionMode,shouldStartEnhanced:!!l.getModuleIfRequireable(),children:[k.jsx(r,{shouldSuspend:this.state.proxyIsInCompositionMode}),k.jsx(m,babelHelpers["extends"]({},a,{className:g(c),composerState:a.composerState,onClick:a.onClick,onCommit:a.onCommit,onComposerStateChange:a.onComposerStateChange,onInputRefUpdated:a.onInputRefUpdated,placeholder:a.placeholder,placeholderClassName:g(d?null:o.emptyPlaceholder),webDriverTestID:e+":rich-input"}))]})})};return c}(k.Component);e.exports=a;function r(a){a=a.shouldSuspend;if(a)throw new(b("Promise"))(function(){});return null}}),null);
__d("useDidUpdateEffect",["React"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a,b){var c=g.useRef(!1);g.useEffect(function(){if(c.current===!1){c.current=!0;return}a()},b)}}),null);
__d("createCometUFIComposerPluginPipeline",["React","useDidUpdateEffect"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function h(a){return a.reduce(function(a,b){return function(){return a(b.apply(void 0,arguments))}})}function a(a){return a.length===0?function(a){var b=a.render;a=babelHelpers.objectWithoutPropertiesLoose(a,["render"]);return g.jsx(b,babelHelpers["extends"]({},a))}:function(c){var d=c.render;c=babelHelpers.objectWithoutPropertiesLoose(c,["render"]);var e=g.useState(function(){return h(a)(d)}),f=e[0],i=e[1];b("useDidUpdateEffect")(function(){i(function(){return h(a)(d)})},[d]);return g.jsx(f,babelHelpers["extends"]({},c))}}}),null);
__d("getCommentDataFromCometUFIComposerState",["UnicodeUtils","emptyFunction","textProbablyWritingMarkdown"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g;function h(a){var c=a.attachmentData,d=a.composerState,e=a.contentBlockToTextWithEntitiesInputMessageMappers,f=a.feedbackID;a=a.inputState;a=a.editorState;var h=[],i=[],j={},k=0,l=a.getCurrentContent();l.getBlockMap().forEach(function(a){var c="",d=0;a.findEntityRanges(b("emptyFunction").thatReturnsTrue,function(f,h){var m=e.some(function(e){e=e(a,l,f,h);var m=a.getText().slice(0,f),n=Math.max(0,m.length-(g||(g=b("UnicodeUtils"))).strlen(m));if(e!=null){m=e.entitiesByID;e=e.message;Object.assign(j,m);c+=e.text;e.ranges&&i.push.apply(i,e.ranges.map(function(a){return a?babelHelpers["extends"]({},a,{offset:a.offset+k-n+d}):a}));d+=e.text.length-(h-f);return!0}return!1});m===!1&&(c+=a.getText().slice(f,h).replace("@[","@ ["))});k+=(g||(g=b("UnicodeUtils"))).strlen(c)+1;h.push(c)});a=h.join("\n");return a.trim()===""&&d.attachment==null?null:{commentData:{attachments:c,feedback_id:f,file_marker:d.fileMarker,formatting_style:d.formattingStyle==null&&b("textProbablyWritingMarkdown")(a)?"MARKDOWN":d.formattingStyle,inline_annotation_data:d.inlineAnnotationData,insights_point_json:d.insightsPoint,message:{ranges:i,text:a},reply_comment_parent_fbid:(c=d.commentAssociatedWithReply)==null?void 0:c.id,reply_target_clicked:d.replyTargetClicked},entitiesByID:j,usedWritingHelpToCompose:d.usedWritingHelpToCompose===!0}}function i(a){var c=a.attachmentData,d=a.composerState,e=a.feedbackID;a=a.inputState;return{commentData:{attachments:c,feedback_id:e,formatting_style:d.formattingStyle==null&&b("textProbablyWritingMarkdown")(a.text)?"MARKDOWN":d.formattingStyle,message:{text:a.text},reply_comment_parent_fbid:(c=d.commentAssociatedWithReply)==null?void 0:c.id,reply_target_clicked:d.replyTargetClicked},entitiesByID:{},usedWritingHelpToCompose:d.usedWritingHelpToCompose===!0}}function a(a){var b=a.attachmentMappers,c=a.composerState;a=a.contentBlockToTextWithEntitiesInputMessageMappers;var d=c.attachment,e=c.feedbackID,f=c.inputState,g;d==null?g=null:d.__type==="ExistingAttachment"?g=[]:g=b.map(function(a){return a(d)}).filter(Boolean);switch(f.__type){case"plain-text":return i({attachmentData:g,composerState:c,feedbackID:e,inputState:f});case"editor-state-based":return h({attachmentData:g,composerState:c,contentBlockToTextWithEntitiesInputMessageMappers:a,feedbackID:e,inputState:f});default:return f.__type}}}),null);
__d("getWindowScrollPosition",[],(function(a,b,c,d,e,f){"use strict";f.getWindowXScrollPosition=a;f.getWindowYScrollPosition=b;function g(){var a;return document.documentElement||((a=document.body)==null?void 0:a.parentNode)||document.body}function a(){var a;return(a=(a=window.pageXOffset)!=null?a:(a=g())==null?void 0:a.scrollLeft)!=null?a:0}function b(){var a;return(a=(a=window.pageYOffset)!=null?a:(a=g())==null?void 0:a.scrollTop)!=null?a:0}}),null);
__d("setFocusOnCometUFIComposerInputState",["FBLogger","ifRequireable"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){var c=a.inputState;switch(c.__type){case"editor-state-based":return b("ifRequireable")("EditorState",function(b){return babelHelpers["extends"]({},a,{inputState:babelHelpers["extends"]({},c,{editorState:b.moveFocusToEnd(c.editorState)})})},function(){b("FBLogger")("ufi2").mustfix("Tried to set focus on a composer state whose inputState was of type `editor-state-based` but the `EditorState` module has not yet been defined. It should not be possible to produce a composer state of that type without the `EditorState` module being defined. Investigate why.");return a});case"plain-text":default:return babelHelpers["extends"]({},a,{inputState:babelHelpers["extends"]({},c,{selectionOffsets:{end:c.text.length,start:c.text.length}})})}}}),null);
__d("CometUFIComposer.react",["BaseScrollableAreaContext","CometErrorBoundary.react","CometRelay","CometTrackingNodeProvider.react","CometUFICommentRow.react","CometUFIComposerActions.react","CometUFIComposerOnBeforeUnloader.react","CometUFIProgressiveComposerInput.react","FBLogger","Random","React","UFI2Config","UFICommonInteractionEvents","UFICommonInteractionLogger","UFIODSLogger","collectDataAttributes","createCometUFIComposerPluginPipeline","getCommentDataFromCometUFIComposerState","getPlainTextFromCometUFIInputState","getWindowScrollPosition","gkx","ifRequireable","unrecoverableViolation","isCometUFIComposerStateEmpty","nullthrows","setFocusOnCometUFIComposerInputState","stylex","useMergeRefs","CometUFIComposer_actor.graphql","CometUFIComposer_feedback.graphql"],(function(a,b,c,d,e,f){"use strict";var g,h,i,j=b("React"),k=b("UFI2Config").composerInputSamplingRateDenominator,l={composerDenial:{backgroundColor:"r898ja9m",borderTop:"pmg7q2s5",borderEnd:"m2wu88kb",borderBottom:"hxpkjkow",borderStart:"czm2i3kx"},disabled:{cursor:"bnpdmtie"},disabledForm:{backgroundColor:"r898ja9m"},emptyInput:{color:"m9osqain",fontSize:"jq4qci2q",fontWeight:"b1v8xokw",textOverflow:"ltmttdrg",whiteSpace:"g0qnabr5",":focus":{color:"r2ndix9n"}},focusPressable:{cursor:"o6r2urh6",position:"l9j0dhe7"},form:{backgroundColor:"b3i9ofy5",borderTopStartRadius:"e72ty7fz",borderTopEndRadius:"qlfml3jp",borderBottomEndRadius:"inkptoze",borderBottomStartRadius:"qmr60zad",borderTopWidth:"rt8b4zig",borderEndWidth:"n8ej3o3l",borderBottomWidth:"agehan2d",borderStartWidth:"sk4xxmp2",display:"j83agx80",justifyContent:"bkfpd7mw"},formWithDraftComment:{flexWrap:"lhclo0ds"},input:{cursor:"o6r2urh6",flexBasis:"mg4g778l",flexGrow:"buofh1pr",flexShrink:"g5gj957u",fontSize:"jq4qci2q",paddingTop:"cxgpxx05",paddingEnd:"d1544ag0",paddingBottom:"sj5x9vvc",paddingStart:"tw6a2znq"}},m=[],n,o=null;n=function(){if(o==null){var a=k||100;o=b("Random").coinflip(a)&&b("gkx")("678290")}return o};var p=function(d){babelHelpers.inheritsLoose(c,d);function c(){var a,c;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(a=c=d.call.apply(d,[this].concat(f))||this,c.state={CometUFIComposerPluginPipeline:b("createCometUFIComposerPluginPipeline")(c.props.initialPlugins||m),composerState:c.props.initialComposerState||{attachment:null,commentAssociatedWithReply:null,feedbackID:b("nullthrows")(c.props.feedback.id,"A `CometUFIComposer` was mounted without a feedback target ID. This is a fatal error, since there's nothing useful a composer can do without one. Please check why the GraphQL query for this feedback object failed to materialize an ID."),formattingStyle:void 0,inputDecorators:[],inputState:b("CometUFIProgressiveComposerInput.react").createEmptyComposerState(),isLocked:!1}},c.$3=[],c.$4=[],c.$5=j.createRef(),c.$6=j.createRef(),c.$7=null,c.$1=null,c.$2=null,c.$8=function(a,d){var e=c.$7;return e?b("collectDataAttributes")(e,a,d):null},c.$10=function(){var a=c.props,d=a.actor,e=a.environment,f=a.feedLocation,g=a.onCommit,h=a.topLevelFeedbackID,i=a.useDefaultActor,j="client:"+b("UFICommonInteractionLogger").makeTrackingID(),k=d.id;if(k==null)throw b("unrecoverableViolation")("We can't commit a comment without knowing the ID of the current actor. Check why the GraphQL query for `viewer_current_actor.id` failed.","ufi2");var l=c.state.composerState.usedWritingHelpToCompose,m=function(a,b){b===void 0&&(b={}),g({actorID:k,clientID:j,commentData:a,entitiesByID:b,environment:e,feedLocation:f,feedbackSource:c.props.feedbackSource,focusCommentID:c.props.focusCommentID,getTrackingDataFn:c.$8,topLevelFeedbackID:h,useDefaultActor:i,usedWritingHelpToCompose:l})};a=c.state.composerState.inputState;if(a.__type==="plain-text"){if(a.text.trim()===""&&c.state.composerState.attachment==null)return;c.$9(j);d=c.state.composerState;var n=d.attachment,o=d.commentAssociatedWithReply;d=d.replyTargetClicked;m({attachments:n&&(n.__type==="ExistingAttachment"?[]:c.$3.map(function(a){return a(n)}).filter(Boolean)),feedback_id:c.state.composerState.feedbackID,formatting_style:c.state.composerState.formattingStyle,message:{text:a.text},reply_comment_parent_fbid:o==null?void 0:o.id,reply_target_clicked:d});c.setState(function(a){return{composerState:babelHelpers["extends"]({},a.composerState,{attachment:null,formattingStyle:void 0,inputState:{__type:"plain-text",selectionOffsets:{end:0,start:0},text:""},replyTargetClicked:!1,usedWritingHelpToCompose:!1})}})}else{c.$9(j);a=function(){var a=b("getCommentDataFromCometUFIComposerState")({attachmentMappers:c.$3,composerState:c.state.composerState,contentBlockToTextWithEntitiesInputMessageMappers:c.$4});if(a==null){c.setState(function(a){if(a.composerState.isLocked)return{composerState:babelHelpers["extends"]({},a.composerState,{isLocked:!1})};else return a});c.props.commentAction==="EDIT"&&m(null,{});return}m(a.commentData,a.entitiesByID);c.setState(function(a){var c=a.composerState.inputState,d=c;switch(c.__type){case"editor-state-based":b("ifRequireable")("EditorState",function(a){d=babelHelpers["extends"]({},c,{editorState:a.moveFocusToEnd(a.createEmpty())})},function(){b("FBLogger")("ufi2").warn("Someone made a comment and we tried to clear the input. The `inputState` was `editor-state-based` but the `EditorState` module was not available on the client. This should be impossible, but here we are. The comment was made but the input was not cleared.")});break;case"plain-text":d=babelHelpers["extends"]({},c,{selectionOffsets:{end:0,start:0},text:""});break;default:c}return{composerState:babelHelpers["extends"]({},a.composerState,{attachment:null,formattingStyle:void 0,inputState:d,isLocked:!1,replyTargetClicked:!1,usedWritingHelpToCompose:!1})}})};c.setState(function(a){return{composerState:babelHelpers["extends"]({},a.composerState,{isLocked:!0})}},a)}},c.$11=function(){n()&&(c.$1=b("UFICommonInteractionLogger").startInteraction(b("UFICommonInteractionEvents").COMET_UFI_COMPOSER_KEYPRESS_LATENCY));return"not-handled"},c.$12=function(a){c.setState(function(b){b=b.composerState;if(b.isLocked)return{};var c=a(b);if(c){b=babelHelpers["extends"]({},b,c);return{composerState:b}}else return null})},c.$13=function(a){c.$7=a,c.props.onInputRefUpdated&&c.props.onInputRefUpdated(a)},c.$14=function(a){var d=c.state.composerState.inputState;switch(d.__type){case"editor-state-based":a.preventDefault();c.setState(function(a){var c=a.composerState.inputState;if(c.__type!=="editor-state-based"){b("FBLogger")("ufi2").warn("While handling a focus trigger click on an editor-state-based input the `inputState` type unexpectedly changed to `%s`.",c.__type);return null}var d=c.editorState,e=d.getSelection();if(e.getHasFocus()===!1){var f=e.set("hasFocus",!0);return b("ifRequireable")("EditorState",function(b){return{composerState:babelHelpers["extends"]({},a.composerState,{inputState:babelHelpers["extends"]({},c,{editorState:b.forceSelection(d,f)})})}},function(){return null})}else return null});break;case"plain-text":default:a.preventDefault(),document.activeElement!==c.$7&&c.focus()}},c.$15=function(a){a.target===c.$6.current&&c.$14(a)},c.$16=function(){var a;for(var b=arguments.length,d=new Array(b),e=0;e<b;e++)d[e]=arguments[e];(a=c.$3).push.apply(a,d);var f=!1;return{remove:function(){if(f)return;f=!0;c.$3=c.$3.filter(function(a){return d.includes(a)===!1})}}},c.$17=function(){var a;for(var b=arguments.length,d=new Array(b),e=0;e<b;e++)d[e]=arguments[e];(a=c.$4).push.apply(a,d);var f=!1;return{remove:function(){if(f)return;f=!0;c.$4=c.$4.filter(function(a){return d.includes(a)===!1})}}},c.isUnfinished=function(){if(c.props.initialComposerState){if(c.props.initialComposerState!==c.state.composerState)return!0}else if(!b("isCometUFIComposerStateEmpty")(c.state.composerState))return!0;return!1},c.$18=function(a){var d=a.actions;a=a.inputProps;var e=c.props,f=e.depth;e=e.placeholder;var g=a.composerState,h=a.isCommentDenied,k=b("getPlainTextFromCometUFIInputState")(g.inputState).trim()!=="";return j.jsxs("form",{className:(i||(i=b("stylex")))(h?l.composerDenial:null,g.isLocked?l.disabled:null,g.isLocked?l.disabledForm:null,l.focusPressable,l.form,k?l.formWithDraftComment:null),onClick:c.$15,ref:c.$6,role:"presentation",children:[j.jsx(b("CometUFIProgressiveComposerInput.react"),{ariaDescribedBy:c.props.ariaDescribedBy,ariaLabel:c.props.ariaLabel,composerState:a.composerState,depth:f,handleBeforeInput:c.$11,handleCommand:a.handleCommand,handleKeyCommand:a.handleKeyCommand,handlePastedFiles:a.handlePastedFiles,keyBindingFn:a.keyBindingFn,onBlur:a.onBlur,onClick:a.onClick,onCommit:a.onCommit,onComposerStateChange:a.onComposerStateChange,onFocus:a.onFocus,onInputRefUpdated:a.onInputRefUpdated,placeholder:(h=a.placeholder)!=null?h:e,ref:c.$5,webDriverTestID:a.webDriverTestID,xstyle:[!k&&l.emptyInput,l.input]}),d?j.jsx(b("CometUFIComposerActions.react"),{children:d}):null]})},a)||babelHelpers.assertThisInitialized(c)}var e=c.prototype;e.componentDidMount=function(){var a=this.props,c=a.depth;a=a.feedbackSource;a===1&&(c===0?b("UFIODSLogger").bump("composer.newsfeed.toplevel.componentDidMount","comet"):b("UFIODSLogger").bump("composer.newsfeed.replies.componentDidMount","comet"))};e.componentDidUpdate=function(a,c){a=this.$1;a!=null&&c.composerState!==this.state.composerState&&(this.$1=null,b("UFICommonInteractionLogger").endInteractionAtEndOfFrame(a))};e.componentWillUnmount=function(){a.cancelAnimationFrame(this.$2)};e.$9=function(a){var c=this.props.commentAction,d=c==="ADD"?b("UFICommonInteractionEvents").COMET_UFI_OPTIMISTIC_COMMENT:b("UFICommonInteractionEvents").COMET_UFI_OPTIMISTIC_COMMENT_EDIT;b("UFICommonInteractionLogger").startInteraction(d,a+d);d=c==="ADD"?b("UFICommonInteractionEvents").COMET_UFI_PERSISTED_COMMENT:b("UFICommonInteractionEvents").COMET_UFI_PERSISTED_COMMENT_EDIT;b("UFICommonInteractionLogger").startInteraction(d,a+d)};e.execCommand=function(a){this.$5.current?this.$5.current.execCommand(a):b("FBLogger")("ufi2").warn("Someone tried to run a `%s` command, but a ref to the composer was not yet available.",a.__type)};e.getElementToScrollTo=function(){return this.$7};e.focus=function(){var c=this.$7;if(!c)return;if(this.state.composerState.inputState.__type==="plain-text"&&!this.state.composerState.isLocked){var d,e=(d=this.props.nearestScrollableArea)==null?void 0:d.getDOMNode();if(e){var f=e.scrollTop;this.$2=a.requestAnimationFrame(function(){e.scrollTop=f})}else{var g=b("getWindowScrollPosition").getWindowXScrollPosition(),h=b("getWindowScrollPosition").getWindowYScrollPosition();this.$2=a.requestAnimationFrame(function(){window.scrollTo(g,h)})}c.focus({preventScroll:!0})}this.$12(function(a){return b("setFocusOnCometUFIComposerInputState")(a)})};e.render=function(){var a=this.props,c=a.actor,d=a.depth,e=a.forceLargeAvatar;e=e===void 0?!1:e;a=a.xstyle;var f=this.state.CometUFIComposerPluginPipeline;return j.jsx(b("CometErrorBoundary.react"),{context:{project:"ufi2"},children:j.jsxs(b("CometTrackingNodeProvider.react"),{trackingNode:34,children:[j.jsx(b("CometUFIComposerOnBeforeUnloader.react"),{isUnfinished:this.isUnfinished}),j.jsx(b("CometUFICommentRow.react"),{actor:c,"data-testid":void 0,depth:d,forceLargeAvatar:e,isComposer:!0,onAvatarClick:this.$14,xstyle:a,children:j.jsx(f,{actions:this.props.actions||m,initialComposerState:this.props.initialComposerState,inputProps:{commentAction:this.props.commentAction,composerState:this.state.composerState,depth:d,onClick:this.$14,onCommit:this.$10,onComposerStateChange:this.$12,onFocus:(c=this.props.onFocus)!=null?c:void 0,onInputRefUpdated:this.$13},onInstallAttachmentMappers:this.$16,onInstallContentBlockToTextWithEntitiesInputMessageMappers:this.$17,render:this.$18})})]})})};return c}(j.Component);function c(a,c){var d=a.actor,e=a.componentRef,f=a.feedback;a=babelHelpers.objectWithoutPropertiesLoose(a,["actor","componentRef","feedback"]);d=b("CometRelay").useFragment(g!==void 0?g:g=b("CometUFIComposer_actor.graphql"),d);f=b("CometRelay").useFragment(h!==void 0?h:h=b("CometUFIComposer_feedback.graphql"),f);var i=b("CometRelay").useRelayEnvironment(),k=j.useContext(b("BaseScrollableAreaContext"));k=k.length===0?void 0:k[k.length-1];return j.jsx(p,babelHelpers["extends"]({},a,{actor:d,environment:i,feedback:f,nearestScrollableArea:k,ref:b("useMergeRefs")(c,e)}))}d=j.forwardRef(c);e.exports=d}),null);