if (self.CavalryLogger) { CavalryLogger.start_js(["0a5i3"]); }

__d("CometPhotoTagBox_photoTagsEdge.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometPhotoTagBox_photoTagsEdge",selections:[{args:null,kind:"FragmentSpread",name:"CometPhotoTagDropdown_photoTagsEdge"}],type:"PhotoTagsEdge",abstractKey:null};e.exports=a}),null);
__d("CometPhotoTagBox_productMatchTag.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometPhotoTagBox_productMatchTag",selections:[{args:null,kind:"FragmentSpread",name:"CometPhotoTagDropdown_productMatchTag"}],type:"ProductTagProductBox",abstractKey:null};e.exports=a}),null);
__d("CometPhotoTagBox_productTag.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometPhotoTagBox_productTag",selections:[{alias:null,args:null,concreteType:"ProductItem",kind:"LinkedField",name:"product_item",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"CometPhotoTagDropdown_productTag"}],type:"ProductTag",abstractKey:null};e.exports=a}),null);
__d("CometPhotoTagDropdown_photoTagsEdge.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}];return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometPhotoTagDropdown_photoTagsEdge",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"source",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Story",kind:"LinkedField",name:"creation_story",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"serialized_frtp_identifiers",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"debug_info",storageKey:null}],storageKey:null}],type:"Photo",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PhotoTag",kind:"LinkedField",name:"tag",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_text_tag",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_product_tag",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"can_viewer_remove_tag",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{kind:"InlineFragment",selections:a,type:"User",abstractKey:null},{kind:"InlineFragment",selections:a,type:"Page",abstractKey:null},{kind:"InlineFragment",selections:a,type:"Group",abstractKey:null}],storageKey:null}],type:"PhotoTagsEdge",abstractKey:null}}();e.exports=a}),null);
__d("CometPhotoTagDropdown_productMatchTag.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometPhotoTagDropdown_productMatchTag",selections:[{alias:null,args:null,concreteType:"ProductTagSuggestedProduct",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,concreteType:"ProductItem",kind:"LinkedField",name:"product_item",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_viewer_seller",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"formatted_price",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null},{alias:null,args:[{kind:"Literal",name:"height",value:140},{kind:"Literal",name:"width",value:140}],concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null}],storageKey:"profile_picture(height:140,width:140)"},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:null}],storageKey:null}],type:"ProductTagProductBox",abstractKey:null};e.exports=a}),null);
__d("CometPhotoTagDropdown_productTag.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometPhotoTagDropdown_productTag",selections:[a,{alias:null,args:null,concreteType:"ProductItem",kind:"LinkedField",name:"product_item",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"is_viewer_seller",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"formatted_price",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null},{alias:null,args:[{kind:"Literal",name:"height",value:140},{kind:"Literal",name:"width",value:140}],concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null}],storageKey:"profile_picture(height:140,width:140)"},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:null}],type:"ProductTag",abstractKey:null}}();e.exports=a}),null);
__d("CometPhotoTagLayerQuery.graphql",["relay-runtime"],(function(a,b,c,d,e,f){"use strict";a=function(){var a={defaultValue:null,kind:"LocalArgument",name:"nodeID"},b={defaultValue:null,kind:"LocalArgument",name:"scale"},c=[{kind:"Variable",name:"id",variableName:"nodeID"}],d={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},h=[g],i={alias:null,args:null,kind:"ScalarField",name:"serialized_frtp_identifiers",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"debug_info",storageKey:null},k=[{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null}];g={alias:null,args:null,concreteType:"ProductItem",kind:"LinkedField",name:"product_item",plural:!1,selections:[e,{alias:null,args:null,kind:"ScalarField",name:"is_viewer_seller",storageKey:null},f,{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"formatted_price",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null},{alias:null,args:[{kind:"Literal",name:"height",value:140},{kind:"Literal",name:"width",value:140}],concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null}],storageKey:"profile_picture(height:140,width:140)"},g],storageKey:null};return{fragment:{argumentDefinitions:[a,b],kind:"Fragment",metadata:null,name:"CometPhotoTagLayerQuery",selections:[{alias:null,args:c,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{kind:"InlineFragment",selections:[{kind:"Defer",selections:[{args:null,kind:"FragmentSpread",name:"CometPhotoTagWrapper_photo"}]}],type:"Photo",abstractKey:null}],type:"Media",abstractKey:"__isMedia"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[b,a],kind:"Operation",name:"CometPhotoTagLayerQuery",selections:[{alias:null,args:c,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,e,{kind:"InlineFragment",selections:[{kind:"InlineFragment",selections:[{"if":null,kind:"Defer",label:"CometPhotoTagLayerQuery$defer$photo-tag-wrapper",selections:[{alias:null,args:[{kind:"Variable",name:"scale",variableName:"scale"}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},e,{alias:null,args:null,concreteType:"PhotoTagsConnection",kind:"LinkedField",name:"tags",plural:!1,selections:[{alias:null,args:null,concreteType:"PhotoTagsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,e,f,{kind:"InlineFragment",selections:h,type:"User",abstractKey:null},{kind:"InlineFragment",selections:h,type:"Page",abstractKey:null},{kind:"InlineFragment",selections:h,type:"Group",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"source",plural:!1,selections:[d,e,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Story",kind:"LinkedField",name:"creation_story",plural:!1,selections:[i,j,e],storageKey:null}],type:"Photo",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PhotoTag",kind:"LinkedField",name:"tag",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_text_tag",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_product_tag",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"can_viewer_remove_tag",storageKey:null},{alias:null,args:null,concreteType:"Vect2",kind:"LinkedField",name:"location",plural:!1,selections:k,storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Story",kind:"LinkedField",name:"creation_story",plural:!1,selections:[i,j,e,{alias:null,args:null,concreteType:"SponsoredData",kind:"LinkedField",name:"sponsored_data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ad_id",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actor",plural:!1,selections:[d,f,e],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"owner",plural:!1,selections:[d,e,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"CommerceMerchantSettings",kind:"LinkedField",name:"preferred_merchant_settings",plural:!1,selections:[{alias:null,args:null,concreteType:"ProductCatalog",kind:"LinkedField",name:"product_catalog",plural:!1,selections:[e],storageKey:null},e],storageKey:null}],type:"Page",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"can_viewer_add_tags",storageKey:null},{alias:null,args:null,concreteType:"ProductTag",kind:"LinkedField",name:"photo_product_tags",plural:!0,selections:[e,g,{alias:null,args:null,concreteType:"Vect2",kind:"LinkedField",name:"xy_location",plural:!1,selections:k,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProductMatchData",kind:"LinkedField",name:"product_matches",plural:!0,selections:[{alias:null,args:null,concreteType:"ProductTagProductBox",kind:"LinkedField",name:"product_box",plural:!1,selections:[{alias:null,args:null,concreteType:"ProductTagSuggestedProduct",kind:"LinkedField",name:"products",plural:!0,selections:[g],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"center_x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"center_y",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Story",kind:"LinkedField",name:"container_story",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"post_id",storageKey:null},e],storageKey:null}]}],type:"Photo",abstractKey:null}],type:"Media",abstractKey:"__isMedia"}],storageKey:null}]},params:{id:"3618044091547274",metadata:{relayPreloadable:!0},name:"CometPhotoTagLayerQuery",operationKind:"query",text:null}}}();a.params.id!=null&&b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a}),null);
__d("CometPhotoTagWrapper_photo.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},b=[a],c=[{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null}],d={alias:null,args:null,concreteType:"Vect2",kind:"LinkedField",name:"xy_location",plural:!1,selections:c,storageKey:null},e={alias:null,args:null,concreteType:"ProductItem",kind:"LinkedField",name:"product_item",plural:!1,selections:b,storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometPhotoTagWrapper_photo",selections:[{alias:null,args:null,concreteType:"Story",kind:"LinkedField",name:"creation_story",plural:!1,selections:[{alias:null,args:null,concreteType:"SponsoredData",kind:"LinkedField",name:"sponsored_data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ad_id",storageKey:null}],storageKey:null}],storageKey:null},a,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"owner",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"CommerceMerchantSettings",kind:"LinkedField",name:"preferred_merchant_settings",plural:!1,selections:[{alias:null,args:null,concreteType:"ProductCatalog",kind:"LinkedField",name:"product_catalog",plural:!1,selections:b,storageKey:null}],storageKey:null}],type:"Page",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"can_viewer_add_tags",storageKey:null},{alias:null,args:null,concreteType:"ProductTag",kind:"LinkedField",name:"photo_product_tags",plural:!0,selections:[d,e,{args:null,kind:"FragmentSpread",name:"CometPhotoTagBox_productTag"}],storageKey:null},{alias:null,args:null,concreteType:"ProductMatchData",kind:"LinkedField",name:"product_matches",plural:!0,selections:[{alias:null,args:null,concreteType:"ProductTagProductBox",kind:"LinkedField",name:"product_box",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"center_x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"center_y",storageKey:null},{args:null,kind:"FragmentSpread",name:"CometPhotoTagBox_productMatchTag"}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PhotoTagsConnection",kind:"LinkedField",name:"tags",plural:!1,selections:[{alias:null,args:null,concreteType:"PhotoTagsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PhotoTag",kind:"LinkedField",name:"tag",plural:!1,selections:[{alias:null,args:null,concreteType:"Vect2",kind:"LinkedField",name:"location",plural:!1,selections:c,storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"CometPhotoTagBox_photoTagsEdge"}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Story",kind:"LinkedField",name:"container_story",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"post_id",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"useCometPhotoTaggerRenderScale_photo"},{args:null,kind:"FragmentSpread",name:"CometPhotoAddTag_photo"},{kind:"InlineDataFragmentSpread",name:"CometAIProductTagSuggestionsUtil_photo",selections:[a,{alias:null,args:null,concreteType:"ProductTag",kind:"LinkedField",name:"photo_product_tags",plural:!0,selections:[a,e,d],storageKey:null}]}],type:"Photo",abstractKey:null}}();e.exports=a}),null);
__d("CometMediaViewerComposer_media.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometMediaViewerComposer_media",selections:[{args:null,kind:"FragmentSpread",name:"CometPhotoViewerTaggedProductsSection_photo"}],type:"Media",abstractKey:"__isMedia"};e.exports=a}),null);
__d("CometMediaViewerComposer_textWithEntities.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}];return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometMediaViewerComposer_textWithEntities",selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,concreteType:"EntityAtRange",kind:"LinkedField",name:"ranges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"entity",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:a,type:"User",abstractKey:null},{kind:"InlineFragment",selections:a,type:"Page",abstractKey:null},{kind:"InlineFragment",selections:a,type:"Group",abstractKey:null},{kind:"InlineFragment",selections:a,type:"Event",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entity_is_weak_reference",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"length",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"offset",storageKey:null}],storageKey:null}],type:"TextWithEntities",abstractKey:null}}();e.exports=a}),null);
__d("useAddGlobalEventListenerOnEffect",["HiddenSubtreeContext","React"],(function(a,b,c,d,e,f){"use strict";e.exports=c;var g=b("React");function c(c){var d=g.useContext(b("HiddenSubtreeContext")).hiddenOrBackgrounded;g.useEffect(function(){if(!d){a.addEventListener("resize",c);return function(){return a.removeEventListener("resize",c)}}},[c,d])}}),null);
__d("CometAIProductTagBox.react",["fbt","CometContextualLayer.react","CometPhotoEditorTagDropdown.react","CometPressable.react","CometProductTagDotHint.react","CometProductTaggingConstants","React","stylex"],(function(a,b,c,d,e,f,g){"use strict";e.exports=c;var h=b("React");function c(c){var d=c.isAddingTag,e=c.isHighlighted,f=c.knownTag,i=c.logImpression,j=c.onDeletePressed,k=c.onHover;c=c.photoID;var l=h.useState(!1),m=l[0],n=l[1];l=h.useReducer(function(a){return a+1});l[0];var o=l[1],p=h.useRef(null),q=h.useRef(null),r=h.useCallback(function(){q.current!=null&&q.current.reposition({autoflip:!0})},[]);h.useEffect(function(){a.addEventListener("resize",r);return function(){a.removeEventListener("resize",r)}},[r]);var s=h.useRef(i);h.useEffect(function(){s.current&&s.current()},[]);var t=function(a){n(a),k(a)};return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"pmk7jnqg oqq733wu",ref:function(a){p.current=a,o()},style:{left:"calc("+f.x+"% - "+b("CometProductTaggingConstants").TOTAL_DOT_SIZE+"px / 2",top:"calc("+f.y+"% - "+b("CometProductTaggingConstants").TOTAL_DOT_SIZE+"px / 2"},children:p.current&&e&&h.jsx(b("CometPressable.react"),{"aria-label":g._("\u0646\u0642\u0637\u0629 \u0627\u0644\u0625\u0634\u0627\u0631\u0629"),onHoverChange:t,overlayDisabled:!0,children:h.jsx(b("CometProductTagDotHint.react"),{borderSize:b("CometProductTaggingConstants").DOT_HINT_BORDER_SIZE,dotSize:b("CometProductTaggingConstants").DOT_HINT_DOT_SIZE,isHighlighted:e,padding:b("CometProductTaggingConstants").DOT_HINT_PADDING})})}),p.current&&(e||m)&&h.jsx(b("CometContextualLayer.react"),{align:"middle",context_DEPRECATED:p.current,imperativeRef:q,position:"below",children:h.jsx(b("CometPhotoEditorTagDropdown.react"),{id:(l=f.productID)!=null?l:"",name:(i=f.taggee.name)!=null?i:"",onDeletePressed:j,onMouseEnter:function(){d||t(!0)},onMouseLeave:function(){t(!1)},photoID:c,productImage:(e=f.taggee.image_uri)!=null?e:"",productPrice:(m=f.taggee.product_price)!=null?m:""})},f.productID)]})}}),null);
__d("CometPhotoTagDropdown.react",["ix","fbt","CometMediaViewerPhotoActions","CometMediaViewerPhotoDeleteTagsAction","CometMenu.react","CometPhotoProductTagMenuItem.react","CometPhotoTagMenuItem.react","CometRelay","CometTooltip.react","CometTrackingNodeProvider.react","React","TetraIcon.react","WebSession","emptyFunction","fbicon","gkx","requireDeferred","stylex","CometPhotoTagDropdown_photoTagsEdge.graphql","CometPhotoTagDropdown_productTag.graphql","CometPhotoTagDropdown_productMatchTag.graphql"],(function(a,b,c,d,e,f,g,h){"use strict";e.exports=a;var i,j,k,l=b("React"),m=b("requireDeferred")("CometMediaRemoveTagFalcoEvent");function n(a,c,d,e){d===void 0&&(d=null);e===void 0&&(e=null);var f=a.nodeID,g=a.onError;a=a.taggee;f={action_source:"photo_tag_dropdown",photo_id:f,surface:"photo_viewer",tags:[{taggee:a}]};b("CometMediaViewerPhotoDeleteTagsAction")({environment:c,extraData:{serialized_frtp_identifiers:d,story_debug_info:e},input:f,onError:g})}function o(a,c,d){c={product_tag_id:c};b("CometMediaViewerPhotoActions").deleteProductTag({environment:d,input:c,onError:a})}function a(a){var c,d,e,f,p=l.useState(!1),q=p[0],r=p[1],s=b("CometRelay").useRelayEnvironment();p=b("CometRelay").useFragment(i!==void 0?i:i=b("CometPhotoTagDropdown_photoTagsEdge.graphql"),a.photoTagsEdge);var t=b("CometRelay").useFragment(j!==void 0?j:j=b("CometPhotoTagDropdown_productTag.graphql"),a.productTag),u=b("CometRelay").useFragment(k!==void 0?k:k=b("CometPhotoTagDropdown_productMatchTag.graphql"),a.productMatchTag),v=a.hoverDropdown,w=a.nodeID,x=a.onMouseEnter,y=a.onMouseLeave,z=a.shouldShowName,A=a.tagModeEnabled,B=t==null?void 0:t.product_item;c=p==null?void 0:(c=p.node)==null?void 0:c.name;var C=B==null?void 0:B.name;d=B==null?void 0:(d=B.formatted_price)==null?void 0:d.text;var D=B==null?void 0:B.id,E=p==null?void 0:(e=p.node)==null?void 0:e.id;e=p==null?void 0:(e=p.tag)==null?void 0:e.is_text_tag;var F=(p==null?void 0:(f=p.tag)==null?void 0:f.is_product_tag)||D!=null,G=e===!0&&F===!1?{name:c}:{id:F?D:E},H=p==null?void 0:(f=p.source)==null?void 0:(e=f.creation_story)==null?void 0:e.serialized_frtp_identifiers,I=p==null?void 0:(f=p.source)==null?void 0:(e=f.creation_story)==null?void 0:e.debug_info,J=function(){return r(!1)};f=function(){var a=t==null?void 0:t.id;F&&a!=null&&a!==""?o(J,a,s):n({nodeID:w,onError:J,taggee:G},s,H,I);var c=b("WebSession").getId();m.onReady(function(a){a.log(function(){return{media_fbid:w,removed_tag_user_id:E,session_id:c}})});r(!0)};e=(e=p==null?void 0:(e=p.node)==null?void 0:e.url)!=null?e:"";var K=function(a){return x(a,q)},L=function(a){return y(a,q)};z=z||v||A&&!B;L=z?l.jsx(b("CometTrackingNodeProvider.react"),{trackingNode:254,children:l.jsxs("div",{className:"j83agx80"+(z?"":" hzruof5a b5wmifdl"),onMouseEnter:K,onMouseLeave:L,children:[c!=null?l.jsx(b("CometMenu.react"),{size:"full",withArrow:!0,children:l.jsx(b("CometPhotoTagMenuItem.react"),{aux:(p==null?void 0:(v=p.tag)==null?void 0:v.can_viewer_remove_tag)===!0?l.jsx(b("TetraIcon.react"),{"aria-label":h._("\u062d\u0630\u0641 \u0627\u0644\u0625\u0634\u0627\u0631\u0629"),color:q?"disabled":"primary",disabled:q,icon:b("fbicon")._(g("478232"),16),onPress:q?b("emptyFunction"):f}):null,disabled:q,href:e!==""?e:"#",primaryText:c,testid:void 0})}):null,C!=null&&d!=null&&D!=null&&b("gkx")("1069716")?l.jsx(b("CometMenu.react"),{size:"full",withArrow:!0,children:l.jsx(b("CometPhotoProductTagMenuItem.react"),{adID:a.adID,aux:(B==null?void 0:B.is_viewer_seller)===!0?l.jsx(b("CometTooltip.react"),{position:"above",tooltip:h._("\u0625\u0632\u0627\u0644\u0629 \u0627\u0644\u0625\u0634\u0627\u0631\u0629 \u0625\u0644\u0649 \u0627\u0644\u0645\u0646\u062a\u062c"),children:l.jsx(b("TetraIcon.react"),{"aria-label":h._("\u0625\u0632\u0627\u0644\u0629 \u0627\u0644\u0625\u0634\u0627\u0631\u0629 \u0625\u0644\u0649 \u0627\u0644\u0645\u0646\u062a\u062c"),color:q?"disabled":"primary",disabled:q,icon:b("fbicon")._(g("478232"),16),onPress:q?b("emptyFunction"):f})}):null,bodyText:d,disabled:q,href:(z=B==null?void 0:B.url)!=null?z:"#",postID:w,primaryText:C,productID:D,profilePictureUri:B==null?void 0:(K=B.profile_picture)==null?void 0:K.uri,tagModeEnabled:A})}):u!=null&&u.products.length>0?l.jsx(b("CometMenu.react"),{header:{title:h._("\u0645\u0646\u062a\u062c\u0627\u062a \u0645\u0634\u0627\u0628\u0647\u0629")},size:"full",truncate:!0,withArrow:!0,children:u.products.map(function(c){if(c==null||c.product_item==null||c.product_item.formatted_price==null)return null;var d=c.product_item,e=d.formatted_price.text,f=d.id;d=d.name;return f==null||d==null||e==null?null:l.jsx(b("CometPhotoProductTagMenuItem.react"),{adID:a.adID,bodyText:e,disabled:q,href:(e=c.product_item.url)!=null?e:"#",isProductMatch:!0,postID:w,primaryText:d,productID:f,profilePictureUri:(e=c.product_item.profile_picture)==null?void 0:e.uri,tagModeEnabled:A},f)}).filter(Boolean)}):null]})}):null;return L}}),null);
__d("CometPhotoTagBox.react",["fbt","CometContextualLayer.react","CometPhotoTagDropdown.react","CometPressable.react","CometProductTagDotHint.react","CometProductTagFunnelIDContext","CometProductTaggingConstants","CometProductTagReferralCodeContext","CometRelay","CommercePdpProductTagClickFalcoEvent","HiddenSubtreeContext","HoveredProductIDContext","ProductTaggingBuyerTypedLogger","React","XCometCommerceProductItemControllerRouteBuilder","stylex","useAddGlobalEventListenerOnEffect","CometPhotoTagBox_photoTagsEdge.graphql","CometPhotoTagBox_productTag.graphql","CometPhotoTagBox_productMatchTag.graphql"],(function(a,b,c,d,e,f,g){"use strict";e.exports=a;var h,i,j,k,l=b("React"),m="product_tag_on_photo_fullscreen_",n="#",o={hideTag:{opacity:"b5wmifdl"},pressable:{borderTopWidth:"rt8b4zig",borderEndWidth:"n8ej3o3l",borderBottomWidth:"agehan2d",borderStartWidth:"sk4xxmp2",paddingTop:"jb3vyjys",paddingEnd:"rz4wbd8a",paddingBottom:"qt6c0cv9",paddingStart:"a8nywdso"},productTagDot:{marginBottom:"obtkqiv7"},tagBox:{borderTop:"p09e4i0s",borderEnd:"q6acmjor",borderBottom:"gis0wc87",borderStart:"maq1zhz7"},tagBoxContainer:{pointerEvents:"oqq733wu",position:"pmk7jnqg"}};function a(a){var c,d=b("CometRelay").useFragment(h!==void 0?h:h=b("CometPhotoTagBox_photoTagsEdge.graphql"),a.photoTagsEdge),e=b("CometRelay").useFragment(i!==void 0?i:i=b("CometPhotoTagBox_productTag.graphql"),a.productTag),f=b("CometRelay").useFragment(j!==void 0?j:j=b("CometPhotoTagBox_productMatchTag.graphql"),a.productMatchTag),p=l.useContext(b("CometProductTagFunnelIDContext")),q=l.useState(!1),r=q[0];q=q[1];var s=l.useState(!1),t=s[0],u=s[1];s=l.useState(!1);var v=s[0],w=s[1];s=l.useState();s[0];var x=s[1];s=l.useContext(b("HiddenSubtreeContext")).hiddenOrBackgrounded_FIXME;var y=l.useRef(null),z=l.useRef(null),A=l.useCallback(function(){z.current!=null&&z.current.reposition({autoflip:!0})},[]);b("useAddGlobalEventListenerOnEffect")(A);l.useEffect(function(){return x(!0)},[]);A=a.borderSize;var B=a.horizontalPercentage,C=a.isAddingTag,D=a.nodeID,E=a.onPressHandler,F=a.tagBoxSize,G=a.tagModeEnabled,H=a.verticalPercentage;A=e==null?F+2*A:b("CometProductTaggingConstants").TOTAL_DOT_SIZE;var I=p!=null?m+D+n+p:m+D,J=e==null?void 0:(c=e.product_item)==null?void 0:c.id,K,L,M=l.useContext(b("CometProductTagReferralCodeContext"));J!=null&&(c=b("XCometCommerceProductItemControllerRouteBuilder").buildURL({listing_id:J,referral_code:I}),K=function(){b("CommercePdpProductTagClickFalcoEvent").log(function(){return{ad_id:a.adID,component:"CometPhotoTagBox",funnel_id:p,marketplace_surface:"photo_fullscreen",post_id:D,product_id:J,referral_code:I}});if(M!=null){var c=new(b("ProductTaggingBuyerTypedLogger"))();c.updateData({component:"CometPhotoTagBox",post_id:D,referral_code:M,surface:"page_photos_tab",unresolved_event:"Actn_PDPProductTagClick"}).log()}},L={linkProps:{url:G?"#":c},onPress:K});var N=l.useContext(b("HoveredProductIDContext"));c=J!=null&&N.hoveredProductID===J;K=v||t||c;return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:(k||(k=b("stylex")))(o.tagBoxContainer,e==null&&f==null?o.hideTag:null),ref:y,style:{left:"calc("+B+"% - "+A+"px / 2",top:"calc("+H+"% - "+A+"px / 2"},children:y.current&&(e!=null||f!=null)?l.jsx(b("CometPressable.react"),babelHelpers["extends"]({"aria-label":g._("\u0646\u0642\u0637\u0629 \u0627\u0644\u0625\u0634\u0627\u0631\u0629"),onHoverChange:q,overlayDisabled:!0,xstyle:o.productTagDot},L,{children:l.jsx("div",{onMouseEnter:function(){w(!0),N.setHoveredProductID(J)},onMouseLeave:function(){w(!1),N.setHoveredProductID(null)},children:l.jsx(b("CometProductTagDotHint.react"),{borderSize:b("CometProductTaggingConstants").DOT_HINT_BORDER_SIZE,dotSize:b("CometProductTaggingConstants").DOT_HINT_DOT_SIZE,isHighlighted:K,padding:b("CometProductTaggingConstants").DOT_HINT_PADDING})})})):l.jsx(b("CometPressable.react"),{"aria-label":g._("\u0645\u0631\u0628\u0639 \u0627\u0644\u0625\u0634\u0627\u0631\u0629"),display:"inline",onHoverChange:q,onPress:E,overlayDisabled:!0,xstyle:o.pressable,children:l.jsx("div",{className:(k||(k=b("stylex")))(o.tagBox),style:{height:F,width:F}})})}),!s&&y.current&&l.jsx(b("CometContextualLayer.react"),{align:"middle",context_DEPRECATED:y.current,imperativeRef:z,position:"below",children:l.jsx(b("CometPhotoTagDropdown.react"),{adID:a.adID,hoverDropdown:K,nodeID:D,onMouseEnter:function(a,b){!C&&!b&&u(!0)},onMouseLeave:function(a,b){!C&&!b&&u(!1)},photoTagsEdge:d,productMatchTag:f,productTag:e,shouldShowName:r,tagModeEnabled:G})},"tagDropdown-"+t.toString())]})}}),null);
__d("ProductTagPhotoViewerOpenTypeaheadClickFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1744227");c=b("FalcoLoggerInternal").create("product_tag_photo_viewer_open_typeahead_click",a);e.exports=c}),null);
__d("CometPhotoTagWrapper.react",["fbt","Actor","CometAIProductTagBox.react","CometAIProductTagSuggestionsUtil.react","CometPhotoAddTag.react","CometPhotoEditorAddProductTag.react","CometPhotoEditorUnknownTagBox.react","CometPhotoTagBox.react","CometPhotoTaggingConstants","CometPhotoViewerViewStateContext","CometPhotoViewerViewStateDispatcherContext","CometPressable.react","CometProductTaggingConstants","CometRelay","JSResource","React","adjustFaceboxPosition","emptyFunction","gkx","lazyLoadComponent","qex","stylex","unrecoverableViolation","useCometPhotoTaggerRenderScale","CometPhotoTagWrapper_photo.graphql","ProductTagPhotoViewerOpenTypeaheadClickFalcoEvent","ProductTagPhotoEditorSuggestionDefineLowConfidenceProductClickFalcoEvent","ProductTagPhotoEditorProductSuggestionLowConfidenceImpressionFalcoEvent","ProductTagPhotoEditorSuggestionRemoveProductClickFalcoEvent"],(function(a,b,c,d,e,f,g){"use strict";e.exports=c;var h,i=b("React"),j=b("lazyLoadComponent")(b("JSResource")("CometPhotoAddProductTag.react").__setRef("CometPhotoTagWrapper.react")),k={tagContainer:{backgroundColor:"g5ia77u1",borderTop:"gcieejh5",borderEnd:"bn081pho",borderBottom:"humdl8nn",borderStart:"izx4hr6d",display:"a8c37x1j",height:"datstx6m",overflowX:"ni8dbmo4",overflowY:"stjgntxs",position:"l9j0dhe7",width:"k4urcfbm",":focus":{outline:"iqfcb0g7"}}};function l(a){var c=a.adID,d=a.index,e=a.isAddingTag,f=a.nodeID,g=a.onPressHandler,h=a.productMatchTag,j=a.productTag,k=a.scaleX,l=a.scaleY,m=a.tagBoxSize,n=a.tagEdge;a=a.tagModeEnabled;if(k==null||l==null)return null;k=k*100;l=l*100;return i.jsx(b("CometPhotoTagBox.react"),{adID:c,borderSize:b("CometPhotoTaggingConstants").BOX_BORDER_SIZE,horizontalPercentage:k,isAddingTag:e,nodeID:f,onPressHandler:g,photoTagsEdge:n,productMatchTag:h,productTag:j,tagBoxSize:m,tagModeEnabled:a,verticalPercentage:l},d)}function c(c){var d,e,f=i.useContext(b("CometPhotoViewerViewStateDispatcherContext")),m=i.useContext(b("CometPhotoViewerViewStateContext")),n=b("CometRelay").useFragment(h!==void 0?h:h=b("CometPhotoTagWrapper_photo.graphql"),c.photo),o=n.can_viewer_add_tags===!0,p=n==null?void 0:(d=n.owner)==null?void 0:d.id,q=(n==null?void 0:(d=n.owner)==null?void 0:(d=d.preferred_merchant_settings)==null?void 0:(d=d.product_catalog)==null?void 0:d.id)||"";d=i.useState(null);var r=d[0],s=d[1];d=i.useState(null);var t=d[0];d=d[1];var u=b("useCometPhotoTaggerRenderScale")({photo:n,refElement:t}),v=c.isTaggingProducts,w=(e=n.container_story)==null?void 0:e.post_id;i.useEffect(function(){c.tagModeEnabled&&o&&s(null)},[o,c.tagModeEnabled]);i.useEffect(function(){if(r!=null){var a=function(){return s(null)};window.addEventListener("resize",a);return function(){window.removeEventListener("resize",a)}}},[r]);i.useEffect(function(){var b=function(a){s(function(b){return b!=null&&a.target.getAttribute("data-name")==="media-viewer-nav-container"?null:b})};a.addEventListener("click",b);return function(){a.removeEventListener("click",b)}},[]);e=b("CometRelay").useQueryLoader(b("CometPhotoEditorAddProductTag.react").sharedCatalogQuery);var x=e[0],y=e[1];e=c.tagBoxSize;var z=c.tagModeEnabled,A=e*u;u=n==null?void 0:(e=n.tags)==null?void 0:e.edges;e=n==null?void 0:n.photo_product_tags;var B=n==null?void 0:n.product_matches,C=n==null?void 0:n.id,D=b("Actor").useActor(),E=D[0];i.useEffect(function(){y({id:E})},[y,E]);var F=((n==null?void 0:(D=n.tags)==null?void 0:D.edges)||[]).map(function(a){return a==null?void 0:(a=a.node)==null?void 0:a.name}).filter(Boolean),G=i.useCallback(function(a){if(t!=null){var c=t.getBoundingClientRect(),d=c.height,e=c.left,f=c.top;c=c.width;var g=v?b("CometProductTaggingConstants").TOTAL_DOT_SIZE:A+2*b("CometPhotoTaggingConstants").BOX_BORDER_SIZE;e=a.clientX-e-g/2;a=a.clientY-f-g/2;f=b("adjustFaceboxPosition")({boxSize:g,imageDimension:c,originalPos:e});e=b("adjustFaceboxPosition")({boxSize:g,imageDimension:d,originalPos:a});if(C==null)throw b("unrecoverableViolation")("CometPhotoAddTag: Cannot find id of photo","comet_ui");v?(b("ProductTagPhotoViewerOpenTypeaheadClickFalcoEvent").log(function(){return{container_post_id:w,creator_id:E,media_id:C,media_type:"photo",platform:"comet",referral_source:"post_viewer"}}),x!=null&&s(i.jsx(j,{catalogID:q,containerPostID:w,existingTags:F,imageHeight:d,imageWidth:c,nodeID:C,onPress:G,onSubmitted:function(){s(null)},queryReference:x,xPos:f,yPos:e},"newTag:horizontal"+f+"vertical"+e))):s(i.jsx(b("CometPhotoAddTag.react"),{borderSize:b("CometPhotoTaggingConstants").BOX_BORDER_SIZE,imageHeight:d,imageWidth:c,onPress:z?G:b("emptyFunction"),onSubmitted:function(){s(null)},photo:n,tagBoxSize:A,xPos:f,yPos:e},"newTag:horizontal"+f+"vertical"+e))}},[t,v,A,C,x,w,E,q,F,z,n]),H=!z&&!v||!o?b("emptyFunction"):G;if(u==null||C==null||e==null||B==null)return null;var I=e.map(function(a){return a==null?void 0:(a=a.product_item)==null?void 0:a.id}),J=(D=n.creation_story)==null?void 0:(D=D.sponsored_data)==null?void 0:D.ad_id;D=u.filter(function(a){return!I.includes(a==null?void 0:(a=a.node)==null?void 0:a.id)}).map(function(a,b){var c;return l({adID:J,index:parseInt((c=a==null?void 0:(c=a.node)==null?void 0:c.id)!=null?c:b,10),isAddingTag:r!=null,isTaggingProducts:v,nodeID:C,onPressHandler:H,scaleX:a==null?void 0:(c=a.tag)==null?void 0:(b=c.location)==null?void 0:b.x,scaleY:a==null?void 0:(c=a.tag)==null?void 0:(b=c.location)==null?void 0:b.y,tagBoxSize:A,tagEdge:a,tagModeEnabled:z})}).filter(Boolean);e=((u=e)!=null?u:[]).map(function(a,b){var c;return(a==null?void 0:a.xy_location)!=null&&l({adID:J,index:parseInt((c=a==null?void 0:(c=a.product_item)==null?void 0:c.id)!=null?c:b,10),isAddingTag:r!=null,isTaggingProducts:v,nodeID:C,onPressHandler:H,productTag:a,scaleX:((b=a==null?void 0:(c=a.xy_location)==null?void 0:c.x)!=null?b:0)/100,scaleY:((b=a==null?void 0:(c=a.xy_location)==null?void 0:c.y)!=null?b:0)/100,tagBoxSize:A,tagModeEnabled:z})}).filter(Boolean);B=b("gkx")("1701489")&&e.length===0&&D.length===0?((u=B)!=null?u:[]).map(function(a,b){return(a==null?void 0:a.product_box)!=null&&v===!1&&l({adID:J,index:b,isAddingTag:!1,isTaggingProducts:v,nodeID:C,onPressHandler:H,productMatchTag:a==null?void 0:a.product_box,scaleX:((b=a==null?void 0:(b=a.product_box)==null?void 0:b.center_x)!=null?b:0)/100,scaleY:((a=a==null?void 0:(b=a.product_box)==null?void 0:b.center_y)!=null?a:0)/100,tagBoxSize:A,tagModeEnabled:z})}).filter(Boolean):[];u=b("CometAIProductTagSuggestionsUtil.react").getUntaggedUnknownTags(n,m.unknownAITags);var K=function(a,c){if(t!=null){var d=t.getBoundingClientRect();if(x!=null){var e=d.width;d=d.height;a=a*e/100-b("CometProductTaggingConstants").TOTAL_DOT_SIZE/2;c=c*d/100-b("CometProductTaggingConstants").TOTAL_DOT_SIZE/2;s(i.jsx(j,{catalogID:q,containerPostID:w,existingTags:F,imageHeight:d,imageWidth:e,nodeID:C,onPress:function(){},onSubmitted:function(){s(null)},queryReference:x,xPos:a,yPos:c},"x"+a+"y"+c));b("ProductTagPhotoEditorSuggestionDefineLowConfidenceProductClickFalcoEvent").log(function(){var a;return{creator_id:(a=n.owner)==null?void 0:a.id,media_id:C,media_type:"photo",platform:"comet",referral_source:"post_viewer"}})}}};u=u.map(function(a,c){return i.jsx(b("CometPhotoEditorUnknownTagBox.react"),{borderSize:b("CometProductTaggingConstants").DOT_HINT_BORDER_SIZE,horizontalPercentage:a.x,isAddingTag:r!=null,logImpression:function(){b("ProductTagPhotoEditorProductSuggestionLowConfidenceImpressionFalcoEvent").log(function(){return{creator_id:p,media_id:C,media_type:"photo",platform:"comet",referral_source:"post_viewer"}})},onPress:K,tagBoxSize:b("CometProductTaggingConstants").DOT_HINT_DOT_SIZE,tagModeEnabled:z,verticalPercentage:a.y},c)});var L=b("CometAIProductTagSuggestionsUtil.react").getUntaggedKnownTags(n,m.knownAITags);L=L.map(function(a,c){return i.jsx(b("CometAIProductTagBox.react"),{isAddingTag:r!=null,isHighlighted:m.highlightedKnownAITagID===a.productID,knownTag:a,onDeletePressed:function(){var c;f({photoID:C,productID:(c=a.productID)!=null?c:"",type:"REMOVE_KNOWN_AI_TAG"});b("ProductTagPhotoEditorSuggestionRemoveProductClickFalcoEvent").log(function(){return{creator_id:p,media_id:C,media_type:"photo",platform:"comet",referral_source:"post_viewer"}})},onHover:function(b){a.productID!=null&&f({hovering:b,id:a.productID,type:"SET_HOVER_FOR_KNOWN_TAG"})},photoID:C},c)});return i.jsxs(i.Fragment,{children:[i.jsxs(b("CometPressable.react"),{display:"inline",label:g._("\u0625\u0634\u0627\u0631\u0629 \u0625\u0644\u0649 \u0635\u0648\u0631\u0629"),onPress:H,overlayDisabled:!0,ref:d,testid:void 0,xstyle:k.tagContainer,children:[D,e,B,z&&b("qex")._("1707804")&&i.jsxs(i.Fragment,{children:[u,L]})]}),z?r:null]})}}),null);
__d("CometPhotoTagLayer.react",["CometPhotoTagWrapper.react","CometRelay","React","CometPhotoTagLayerQuery.graphql"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g,h=b("React"),i=g!==void 0?g:g=b("CometPhotoTagLayerQuery.graphql");function a(a){var c=a.photoTagLayerQueryReference;a=babelHelpers.objectWithoutPropertiesLoose(a,["photoTagLayerQueryReference"]);c=b("CometRelay").usePreloadedQuery(i,c);c=c==null?void 0:c.node;return c==null?null:h.jsx(b("CometPhotoTagWrapper.react"),babelHelpers["extends"]({photo:c},a))}}),null);
__d("CometMediaViewerComposerEmojiButton.react",["ix","fbt","CometComposerEmojiPickerTrigger.react","CometPressable.react","React","TetraIcon.react","fbicon","stylex"],(function(a,b,c,d,e,f,g,h){"use strict";e.exports=a;var i=b("React");function a(a){return i.jsx(b("CometComposerEmojiPickerTrigger.react"),{align:"end",position:"below",children:function(a,c){return i.jsx(b("CometPressable.react"),{"aria-label":h._("\u0625\u062f\u0631\u0627\u062c \u0631\u0645\u0632 \u062a\u0639\u0628\u064a\u0631\u064a"),display:"inline",onPress:c,overlayDisabled:!0,ref:a,children:i.jsx("div",{className:"b3onmgus pby63qed ph5uu5jm ecm0bbzt",children:i.jsx(b("TetraIcon.react"),{color:"disabled",icon:b("fbicon")._(g("642533"),16)})})})}})}}),null);
__d("CometMediaViewerComposer.react",["fbt","CometComposer.react","CometComposerEditor.react","CometMediaViewerComposerEmojiButton.react","CometMediaViewerPhotoActions","CometMediaViewerVideoActions","CometRelay","React","TetraButton.react","TetraText.react","createCometComposerEditorStateFromTextWithEntities","createCometComposerMentionsEntity","createComposerDeferredPlugin","getDeferredComposerTransformer","reduceComposerViewStateToCreationData","requireCond","requireDeferred","stylex","cr:1536687","CometMediaViewerComposer_media.graphql","CometMediaViewerComposer_textWithEntities.graphql"],(function(a,b,c,d,e,f,g){"use strict";e.exports=a;var h,i,j=b("React"),k=b("createComposerDeferredPlugin")((c=b("requireDeferred"))("CometPhotoViewerTaggedProductsSection.react")),l=b("createComposerDeferredPlugin")(c("CometComposerMisinformationLinkDetectorPlugin.react")),m=b("createComposerDeferredPlugin")(c("CometMediaViewerComposerMentionsPlugin.react"));d=c("composerMessageMediaViewerTransform");var n=[b("getDeferredComposerTransformer")(d)];function o(a,c){var d=[];for(var e=0;e<c.length;e++){var f=c[e];f!=null&&f.offset!=null&&f.length!=null&&f.entity!=null&&f.entity.__typename!=null&&d.push({entity:f.entity,entity_is_weak_reference:f==null?void 0:f.entity_is_weak_reference,length:f.length,offset:f.offset})}return b("createCometComposerEditorStateFromTextWithEntities")({ranges:d,text:(f=a)!=null?f:""},function(a,c){a=a.entity;var d=a.__typename;a=a.id;return(d==="User"||d==="Page"||d==="Event"||d==="Group")&&a!=null?b("createCometComposerMentionsEntity")(a,!1,c):null})}function a(a){var c=j.useState(!1),d=c[0],e=c[1],f=b("CometRelay").useRelayEnvironment();c=j.useState(null);var p=c[0],q=c[1];c=a.media;var r=a.mediaType,s=a.message,t=a.nodeID,u=a.setIsEditing,v=b("CometRelay").useFragment(h!==void 0?h:h=b("CometMediaViewerComposer_media.graphql"),c),w=b("CometRelay").useFragment(i!==void 0?i:i=b("CometMediaViewerComposer_textWithEntities.graphql"),s);c=j.useCallback(function(){var a;if(w==null)return{__type:"plain-text",hasFocus:!1,isComposing:!1,isPendingSelection:!1,selectionOffsets:null,text:""};var b=w.text;a=(a=w==null?void 0:w.ranges)!=null?a:[];return o(b,a)},[w]);s=j.useCallback(function(a){var c=r==="video"?b("CometMediaViewerVideoActions"):b("CometMediaViewerPhotoActions"),d="",g=a==null?void 0:a.editorState;g!=null&&(g.__type==="editor-state-based"?d=g.draftEditorState.getCurrentContent().getPlainText():d=g.text);b("reduceComposerViewStateToCreationData")(a,n,{id:t,message:{text:d}},function(a){q(null),e(!0),c.edit({environment:f,input:{id:t,message:a.message},onCompleted:function(){u!=null&&u(!1)},onError:function(){u!=null&&u(!1)}})})},[r,t,f,u]);var x=p!=null?Object.keys(p):[];return j.jsx("div",{children:j.jsx(b("CometComposer.react"),{beginningViewState:{editorState:c()},onSubmitCommit:s,children:function(c){return j.jsxs(j.Fragment,{children:[p&&x.length>0?j.jsx("div",{children:x.map(function(a,c){return j.jsx(b("TetraText.react"),{color:"negative",type:"body3",children:p[a]},c)})}):null,j.jsx(m,{nodeID:t,position:"below"}),j.jsx(b("cr:1536687"),{}),j.jsx(l,{composerType:"feed"}),j.jsxs("div",{className:"pxsmfnpt n851cfcs i1fnvgqd cbu4d94t j83agx80 oo9gr5id",children:[j.jsx(b("CometComposerEditor.react"),{placeholder:"Add a description",readOnly:d}),j.jsx("div",{className:"bkfpd7mw j83agx80",children:j.jsx(b("CometMediaViewerComposerEmojiButton.react"),{})}),j.jsx(k,{isEditMode:!0,photo:v})]}),j.jsxs("div",{className:"j83agx80",children:[j.jsx("div",{children:a.submitButton({disabled:d,submitForm:c})}),j.jsx("div",{className:"b3onmgus",children:j.jsx(b("TetraButton.react"),{disabled:d,label:g._("\u0625\u0644\u063a\u0627\u0621"),onPress:function(){u!=null&&u(!1)},type:"secondary"})})]})]})}})})}}),null);
__d("useCometMediaViewerComposerMentionsStrategyResolver",["React","createCometAtSignComposerMentionStrategy","createCometCapitalizedNameMentionStrategy","useCometMediaViewerComposerMentionsDataSource","useCometMentionsStrategyResolver"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=b("useCometMediaViewerComposerMentionsDataSource")({config:{bootstrap:{firstDegreeFinderOptions:["FRIENDS_ONLY"],mentionTypes:["USER"]},network:{mentionTypes:["user","group","event","page"]}},existingIDs:[],limit:5,photoID:a}),d=b("useCometMediaViewerComposerMentionsDataSource")({config:{bootstrap:{firstDegreeFinderOptions:["FRIENDS_ONLY"],mentionTypes:["USER"]},network:{mentionTypes:["user"]}},existingIDs:[],limit:5,photoID:a});a=g.useMemo(function(){return[{dataSource:c,searchStrategy:b("createCometAtSignComposerMentionStrategy")({minMatchLength:1})},{dataSource:d,searchStrategy:b("createCometCapitalizedNameMentionStrategy")({minMatchLength:3})}]},[c,d]);return b("useCometMentionsStrategyResolver")(a)}}),null);
__d("CometMediaViewerComposerMentionsPlugin.react",["CometComposerMentionsPlugin.react","FeedComposerCometMentionsTypeheadListItem.react","React","createCometComposerMentionsEntity","getCometComposerMentionsSearch","useCometMediaViewerComposerMentionsStrategyResolver","withComposerViewStatePart"],(function(a,b,c,d,e,f){"use strict";var g=b("React");function h(a){return a.getLabel()}function i(a,c){return b("createCometComposerMentionsEntity")(c.getKey(),!1,a)}function a(a){var c=a.currentBlockKey,d=a.nodeID;a=a.position;a=a===void 0?"above":a;d=b("useCometMediaViewerComposerMentionsStrategyResolver")(d);return g.jsx(b("CometComposerMentionsPlugin.react"),{currentBlockKey:c,getReplacementString:h,getSearchText:b("getCometComposerMentionsSearch"),onMentionCreateContentState:i,position:a,priority:1,strategyResolver:d,viewItemStrategyRenderer:b("FeedComposerCometMentionsTypeheadListItem.react")})}c=b("withComposerViewStatePart")(a,function(a){a=a==null?void 0:a.editorState;a=a!=null&&a.__type==="editor-state-based"?a.draftEditorState:null;return{currentBlockKey:a!=null?a.getSelection().getStartKey():null}});e.exports=c}),null);
__d("composerMessageMediaViewerTransform",["cometComposerMentionsBlockToEntity","getPlainTextFromDeferredDraftEditorState","transformDraftEditorStateToTextWithEntities"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a,c,d){a=a.editorState;if(a==null)d(c);else if(a.__type==="plain-text")d(babelHelpers["extends"]({},c,{message:{text:b("getPlainTextFromDeferredDraftEditorState")(a)}}));else if(a.__type==="editor-state-based"){a=a.draftEditorState;a=b("transformDraftEditorStateToTextWithEntities")(a,[b("cometComposerMentionsBlockToEntity")]);d(babelHelpers["extends"]({},c,{message:a}))}}}),null);
__d("CometMediaOptionsClickFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1743381");c=b("FalcoLoggerInternal").create("comet_media_options_click",a);e.exports=c}),null);
__d("CometMediaTagFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1743383");c=b("FalcoLoggerInternal").create("comet_media_tag",a);e.exports=c}),null);